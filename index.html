<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inkunabule — karta s filtrima</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
<style>
  html, body, #map { height: 100%; margin: 0; }
  .panel {
    position: absolute; top: 10px; left: 10px; z-index: 1000;
    background: rgba(255,255,255,0.95); padding: 10px; border-radius: 10px; border: 1px solid #ddd;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; font-size: 14px; max-width: 360px;
  }
  .panel h3 { margin: 0 0 8px 0; font-size: 16px; }
  .panel label { display:block; margin-top: 6px; font-weight: 600; }
  .panel input[type="text"], .panel select { width: 100%; padding: 6px; border:1px solid #ccc; border-radius:8px; }
  .row { display:flex; gap:8px; align-items:center; }
  .row > div { flex:1; }
  .btns { display:flex; gap:8px; margin-top:8px; }
  button { padding:6px 10px; border:1px solid #ccc; border-radius:8px; background:#f6f6f6; cursor:pointer; }
  button:hover { background:#eee; }
  .tab-wrap { font-family: inherit; }
  .tab-input { position:absolute; opacity:0; }
  .tab-label {
    display:inline-block; padding:6px 10px; margin-right:6px;
    border:1px solid #888; border-bottom:none; border-radius:6px 6px 0 0;
    background:#f0f0f0; cursor:pointer; font-size:13px;
  }
  .tab-panel {
    border:1px solid #888; padding:6px; max-height:240px; overflow:auto;
    background:#fff; border-radius:0 6px 6px 6px;
  }
  .tab-input:checked + .tab-label { background:#fff; font-weight:bold; }
  .tab-input:checked + .tab-label + .tab-panel { display:block; }
  .tab-panel { display:none; }
  .table-mini { width:100%; border-collapse:collapse; font-size:13px; }
  .table-mini th, .table-mini td { padding:4px; border-bottom:1px solid #eee; }
  .table-mini th { text-align:left; }
  .table-mini td.num { text-align:right; }
  .headerline { margin:2px 0 6px 0; font-size:12px; color:#444; }
</style>
</head>
<body>
<div id="map"></div>

<div class="panel">
  <h3>Filtri</h3>
  <label>Mjesto tiskanja (pretraga)</label>
  <input type="text" id="placeSearch" placeholder="npr. Venecija">
  <label>Tiskar</label>
  <select id="printerSelect">
    <option value="">(svi tiskari)</option>
  </select>
  <div class="row">
    <div>
      <label>Godina od</label>
      <input type="number" id="yearMin" min="1200" max="1900" step="1">
    </div>
    <div>
      <label>Godina do</label>
      <input type="number" id="yearMax" min="1200" max="1900" step="1">
    </div>
  </div>
  <div class="btns">
    <button id="applyBtn">Primijeni</button>
    <button id="resetBtn">Poništi</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script>
  const PLACES = [{"place": "Augsburg", "lat": 48.3690341, "lon": 10.8979522, "total": 1, "printers": [{"name": "Ratdolt, Erhard", "count": 1}], "years": [{"year": 1489, "count": 1}], "titles": [{"author": "ALBUMASAR", "title": "Introductorium in astronomiam", "year": 1489, "printer": "Ratdolt, Erhard", "count": 1}], "storage": [{"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Basel", "lat": 47.5581077, "lon": 7.5878261, "total": 6, "printers": [{"name": "Kessler, Nicolaus", "count": 6}], "years": [{"year": 1489, "count": 3}, {"year": 1497, "count": 3}], "titles": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "printer": "Kessler, Nicolaus", "count": 3}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Kessler, Nicolaus", "count": 3}], "storage": [{"place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina", "count": 1}, {"place": "Split", "institution": "Arheološki muzej", "count": 2}, {"place": "Split", "institution": "Katolički bogoslovni fakultet", "count": 1}, {"place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti", "count": 1}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Bologna", "lat": 44.4938203, "lon": 11.3426327, "total": 1, "printers": [{"name": "Benedictis, Franciscus (Plato) de", "count": 1}], "years": [{"year": 1488, "count": 1}], "titles": [{"author": "SUETONIUS TRANQUILLUS, GAIUS", "title": "Vitae XII caesarum", "year": 1488, "printer": "Benedictis, Franciscus (Plato) de", "count": 1}], "storage": [{"place": "Dubrovnik", "institution": "Franjevački samostan Male braće", "count": 1}]}, {"place": "Brescia", "lat": 45.7795805, "lon": 10.425873, "total": 32, "printers": [{"name": "Dobrićević, Dobrić", "count": 28}, {"name": "Dobrićević, Dobrić Delsera, Miniatus", "count": 2}, {"name": "Dobrićević, Dobrić Manerva, Bonifacius de", "count": 2}], "years": [{"year": 1482, "count": 2}, {"year": 1483, "count": 4}, {"year": 1485, "count": 15}, {"year": 1486, "count": 6}, {"year": 1487, "count": 2}, {"year": 1490, "count": 3}], "titles": [{"author": "", "title": "Statuta Cremonae", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "AESOPUS", "title": "Aesopus moralisatus", "year": 1487, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "ALIGHIERI, DANTE", "title": "La Commedia", "year": 1487, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "printer": "Dobrićević, Dobrić", "count": 3}, {"author": "CATULLUS, GAIUS VALERIUS", "title": "Carmina", "year": 1486, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "FESTUS, SEXTUS POMPEIUS", "title": "De verborum significatione", "year": 1483, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 5}, {"author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 3}, {"author": "LUDOVICUS A TURRI DE VERONA", "title": "De immaculata conceptione B.V. Mariae", "year": 1486, "printer": "Dobrićević, Dobrić", "count": 2}, {"author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 4}, {"author": "NONIUS MARCELLUS", "title": "De proprietate Latini sermonis.", "year": 1483, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "ODONIS, GERALDUS", "title": "Expositio in Aristotelis Ethica", "year": 1482, "printer": "Dobrićević, Dobrić Manerva, Bonifacius de", "count": 2}, {"author": "PLUTARCHUS", "title": "De claris mulieribus. De virtutibus mulierum.", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "PLUTARCHUS", "title": "Parallela minora", "year": 1485, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "PROBUS, MARCUS VALERIUS", "title": "De interpretandis Romanorum litteris.", "year": 1486, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1486, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "TIBULLUS, ALBIUS", "title": "Elegiae sive carmina", "year": 1486, "printer": "Dobrićević, Dobrić", "count": 1}, {"author": "VARRO, MARCUS TERENTIUS", "title": "De lingua Latina lib. III.", "year": 1483, "printer": "Dobrićević, Dobrić Delsera, Miniatus", "count": 2}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 14}, {"place": "Dubrovnik", "institution": "Državni arhiv Dubrovnik", "count": 1}, {"place": "Dubrovnik", "institution": "Franjevački samostan Male braće", "count": 1}, {"place": "Dubrovnik", "institution": "Znanstvena knjižnica", "count": 2}, {"place": "Hvar", "institution": "Franjevački samostan Gospe od milosti", "count": 1}, {"place": "Korèula", "institution": "Opatska knjižnica", "count": 2}, {"place": "Visovac", "institution": "Franjevački samostan Gospe od anđela", "count": 1}, {"place": "Zagreb", "institution": "Metropolitanska knjižnica", "count": 3}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 6}, {"place": "Šibenik", "institution": "Franjevački samostan sv. Frane", "count": 1}]}, {"place": "Cremona", "lat": 45.2208641, "lon": 10.037038, "total": 1, "printers": [{"name": "Darleri, Carlo", "count": 1}], "years": [{"year": 1494, "count": 1}], "titles": [{"author": "AEGIDII, GUILLERMUS", "title": "Super coelestium motuum indigatione", "year": 1494, "printer": "Darleri, Carlo", "count": 1}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 1}]}, {"place": "Ferrara", "lat": 44.7667642, "lon": 11.827939, "total": 1, "printers": [{"name": "Rubeis, Laurentius de, de Valentia", "count": 1}], "years": [{"year": 1497, "count": 1}], "titles": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Rubeis, Laurentius de, de Valentia", "count": 1}], "storage": [{"place": "Šibenik", "institution": "Franjevački samostan sv. Frane", "count": 1}]}, {"place": "Firenza", "lat": 29.4963881, "lon": -95.0507461, "total": 8, "printers": [{"name": "Bonaccorsi, Francesco", "count": 1}, {"name": "Libris, Bartholomeo de", "count": 5}, {"name": "Nepoznat", "count": 2}], "years": [{"year": 1490, "count": 1}, {"year": 1499, "count": 7}], "titles": [{"author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "count": 5}, {"author": "DRAGIŠIÆ, JURAJ", "title": "Oratio funebris pro Junio Georgio habita", "year": 1499, "printer": "Nepoznat", "count": 2}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1490, "printer": "Bonaccorsi, Francesco", "count": 1}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 1}, {"place": "Dubrovnik", "institution": "Franjevački samostan Male braće", "count": 2}, {"place": "Dubrovnik", "institution": "Znanstvena knjižnica", "count": 1}, {"place": "Split", "institution": "Arheološki muzej", "count": 1}, {"place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'", "count": 1}, {"place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti", "count": 1}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Lyon", "lat": 45.7578137, "lon": 4.8320114, "total": 1, "printers": [{"name": "Dobrićević, Dobrić", "count": 1}], "years": [{"year": 1501, "count": 1}], "titles": [{"author": "", "title": "OFFICIUM", "year": 1501, "printer": "Dobrićević, Dobrić", "count": 1}], "storage": [{"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Löwen", "lat": 50.879202, "lon": 4.7011675, "total": 1, "printers": [{"name": "Braem, Konrad", "count": 1}], "years": [{"year": 1480, "count": 1}], "titles": [{"author": "DIONYSIUS CARTHUSIANUS", "title": "Dialogus Mariae et peccatoris etc.", "year": 1480, "printer": "Braem, Konrad", "count": 1}], "storage": [{"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Nürnberg", "lat": 49.453872, "lon": 11.077298, "total": 1, "printers": [{"name": "Wagner, Petrus", "count": 1}], "years": [{"year": 1489, "count": 1}], "titles": [{"author": "FIDELIS, CASSANDRA", "title": "Oratio pro Bertucio Lamberto etc.", "year": 1489, "printer": "Wagner, Petrus", "count": 1}], "storage": [{"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}, {"place": "Padova", "lat": 45.391408, "lon": 11.8058487, "total": 1, "printers": [{"name": "Siliprandi, Domenico", "count": 1}], "years": [{"year": 1475, "count": 1}], "titles": [{"author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1475, "printer": "Siliprandi, Domenico", "count": 1}], "storage": [{"place": "Pula", "institution": "Sveučilišna knjižnica u Puli", "count": 1}]}, {"place": "Parma", "lat": 44.6952006, "lon": 10.0979869, "total": 4, "printers": [{"name": "Typ. Hieronymi", "count": 4}], "years": [{"year": 1480, "count": 4}], "titles": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "printer": "Typ. Hieronymi", "count": 4}], "storage": [{"place": "Dubrovnik", "institution": "Franjevački samostan Male braće", "count": 1}, {"place": "Split", "institution": "Dominikanski samostan sv. Katarine", "count": 1}, {"place": "Split", "institution": "Franjevački samostan svetog Ante", "count": 1}, {"place": "Zadar", "institution": "Franjevački samostan sv. Frane", "count": 1}]}, {"place": "Rim", "lat": 41.8933203, "lon": 12.4829321, "total": 8, "printers": [{"name": "Gensberg, Johannes", "count": 1}, {"name": "Guldinbeck, Bartholomaeus", "count": 1}, {"name": "Plannck, Stephan", "count": 2}, {"name": "Silber, Eucharius", "count": 2}, {"name": "Sweynheym, Konrad Pannartz, Arnold", "count": 2}], "years": [{"year": 1470, "count": 2}, {"year": 1474, "count": 1}, {"year": 1481, "count": 1}, {"year": 1484, "count": 1}, {"year": 1490, "count": 1}, {"year": 1492, "count": 1}, {"year": 1494, "count": 1}], "titles": [{"author": "ARISTOTELES", "title": "Politica", "year": 1492, "printer": "Silber, Eucharius", "count": 1}, {"author": "BUNIÆ, JAKOV", "title": "De raptu Cerberi libri tres.", "year": 1490, "printer": "Plannck, Stephan", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1470, "printer": "Sweynheym, Konrad Pannartz, Arnold", "count": 2}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1474, "printer": "Gensberg, Johannes", "count": 1}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1481, "printer": "Plannck, Stephan", "count": 1}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Reverendissimi domini D. Petri Cardinalis sancti Sixti habita a revere[n]do patre d[omi]no Nicolao ep[isco]po Modrusien[si]", "year": 1484, "printer": "Guldinbeck, Bartholomaeus", "count": 1}, {"author": "NIMIRA, MARTINUS DE", "title": "Sermo de passione Domini.", "year": 1494, "printer": "Silber, Eucharius", "count": 1}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 2}, {"place": "Split", "institution": "Prva gimnazija Split", "count": 1}, {"place": "Zagreb", "institution": "Franjevački samostan sv. Franje Asiškog", "count": 1}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 3}, {"place": "Šibenik", "institution": "Franjevački samostan sv. Lovre", "count": 1}]}, {"place": "Senj", "lat": 44.9901533, "lon": 14.9021159, "total": 2, "printers": [{"name": "Baromić, Blaž", "count": 1}, {"name": "Bedrièić, Silvestar Turèić, Gašpar Baromić, Blaž", "count": 1}], "years": [{"year": 1494, "count": 1}, {"year": 1496, "count": 1}], "titles": [{"author": "", "title": "Senjski glagoljski misal", "year": 1494, "printer": "Bedrièić, Silvestar Turèić, Gašpar Baromić, Blaž", "count": 1}, {"author": "Carcano, Michele", "title": "Spovid općena", "year": 1496, "printer": "Baromić, Blaž", "count": 1}], "storage": [{"place": "Cres", "institution": "Franjevački samostan sv. Franje", "count": 1}, {"place": "Zagreb", "institution": "Samostan sv. Franje ksaverskoga", "count": 1}]}, {"place": "Treviso", "lat": 45.8066913, "lon": 12.2063158, "total": 1, "printers": [{"name": "Manzolus, Michael", "count": 1}], "years": [{"year": 1480, "count": 1}], "titles": [{"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1480, "printer": "Manzolus, Michael", "count": 1}], "storage": [{"place": "Šibenik", "institution": "Franjevački samostan sv. Frane", "count": 1}]}, {"place": "Venecija", "lat": 45.4371908, "lon": 12.3345898, "total": 94, "printers": [{"name": "Adamus, Rotwilensis", "count": 1}, {"name": "Benalius, Bernardinus", "count": 1}, {"name": "Bevilacqua, Simone", "count": 1}, {"name": "Capcasa, Matteo", "count": 1}, {"name": "Damianus de Gorgonzola", "count": 4}, {"name": "Gallo, Guglielmo", "count": 2}, {"name": "Girardengus, Nicolaus, de Novis", "count": 1}, {"name": "Gregoriis, Johannes de", "count": 7}, {"name": "Grgur Senjanin Jacobum Britannicum", "count": 4}, {"name": "Hannibal Foxius", "count": 1}, {"name": "Miscomini, Antonio di Bartolommeo", "count": 5}, {"name": "Paganini, Paganino de’, st.", "count": 2}, {"name": "Paltašić, Andrija", "count": 34}, {"name": "Paltašić, Andrija Dobrićević, Dobrić", "count": 3}, {"name": "Paltašić, Andrija Scotus, Octavianus", "count": 3}, {"name": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "count": 2}, {"name": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "count": 2}, {"name": "Pietro, Gabriele di", "count": 1}, {"name": "Pincius, Doninus", "count": 1}, {"name": "Ratdolt, Erhard Löslein, Peter", "count": 4}, {"name": "Scotus, Octavianus", "count": 4}, {"name": "Tacuinus, Giovanni", "count": 1}, {"name": "Torresanus, Andreas, de Asula Baromić, Blaž", "count": 2}, {"name": "Vercellensis, Johannes Rubeus", "count": 7}], "years": [{"year": 1475, "count": 1}, {"year": 1476, "count": 7}, {"year": 1477, "count": 12}, {"year": 1478, "count": 4}, {"year": 1479, "count": 1}, {"year": 1480, "count": 2}, {"year": 1482, "count": 3}, {"year": 1483, "count": 8}, {"year": 1484, "count": 1}, {"year": 1485, "count": 5}, {"year": 1487, "count": 7}, {"year": 1488, "count": 6}, {"year": 1490, "count": 3}, {"year": 1491, "count": 2}, {"year": 1492, "count": 5}, {"year": 1493, "count": 2}, {"year": 1495, "count": 7}, {"year": 1496, "count": 8}, {"year": 1497, "count": 8}, {"year": 1498, "count": 2}], "titles": [{"author": "", "title": "BIBLIA", "year": 1484, "printer": "Paltašić, Andrija", "count": 1}, {"author": "", "title": "Breviarium romanum", "year": 1493, "printer": "Torresanus, Andreas, de Asula Baromić, Blaž", "count": 2}, {"author": "", "title": "EVANGELISTARIUM ILLYRICUM", "year": 1495, "printer": "Damianus de Gorgonzola", "count": 2}, {"author": "", "title": "Elegiae", "year": 1487, "printer": "Paltašić, Andrija", "count": 1}, {"author": "ALBERTUS DE SAXONIA", "title": "De proportionibus.", "year": 1487, "printer": "Paltašić, Andrija", "count": 2}, {"author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "printer": "Grgur Senjanin Jacobum Britannicum", "count": 4}, {"author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "printer": "Paltašić, Andrija", "count": 3}, {"author": "AURELIUS, VICTOR SEXTUS", "title": "De viris illustribus", "year": 1477, "printer": "Paltašić, Andrija", "count": 2}, {"author": "Aristotelis", "title": "Auctoritates", "year": 1495, "printer": "Paganini, Paganino de’, st.", "count": 2}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Codicis cum additionibus Alexandri Tartagni.", "year": 1491, "printer": "Paltašić, Andrija", "count": 2}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1490, "printer": "Paltašić, Andrija", "count": 1}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Codicis cum additionibus Alexandri Tartagni.", "year": 1490, "printer": "Paltašić, Andrija", "count": 1}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1492, "printer": "Paltašić, Andrija", "count": 2}, {"author": "BURLAEUS, GUALTHERUS", "title": "Expositio in artem veterem Porphyrii et Aristotelis", "year": 1492, "printer": "Paltašić, Andrija", "count": 2}, {"author": "CICERO, MARCUS TULLIUS", "title": "De oratore", "year": 1478, "printer": "Paltašić, Andrija", "count": 1}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares", "year": 1487, "printer": "Paltašić, Andrija", "count": 1}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares (comm. Hubertinus Clericus Crescentinas)", "year": 1488, "printer": "Paltašić, Andrija", "count": 1}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistole ad familiares", "year": 1480, "printer": "Paltašić, Andrija", "count": 2}, {"author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "printer": "Ratdolt, Erhard Löslein, Peter", "count": 4}, {"author": "DIODORUS, SICULUS Tacitus, Gaius Cornelius", "title": "Bibliothecae historicae libri VI.", "year": 1476, "printer": "Paltašić, Andrija", "count": 2}, {"author": "FICINUS, MARSILIUS", "title": "De triplici vita", "year": 1498, "printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "count": 1}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "printer": "Paltašić, Andrija", "count": 3}, {"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "count": 7}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "count": 4}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Pincius, Doninus", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "count": 7}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistole", "year": 1490, "printer": "Benalius, Bernardinus", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1475, "printer": "Pietro, Gabriele di", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1485, "printer": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "count": 2}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1487, "printer": "Hannibal Foxius", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "printer": "Girardengus, Nicolaus, de Novis", "count": 1}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "printer": "Scotus, Octavianus", "count": 4}, {"author": "IUVENALIS, DECIMUS IUNIUS", "title": "Satyrae", "year": 1488, "printer": "Paltašić, Andrija", "count": 1}, {"author": "JACOBUS DE VORAGINE", "title": "Legenda aurea sanctorum, sive Lombardica historia", "year": 1482, "printer": "Paltašić, Andrija Scotus, Octavianus", "count": 1}, {"author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "printer": "Paltašić, Andrija Dobrićević, Dobrić", "count": 3}, {"author": "MARCHESINUS, JOHANNES", "title": "Mammotrectus super Bibliam.", "year": 1482, "printer": "Paltašić, Andrija Scotus, Octavianus", "count": 2}, {"author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1492, "printer": "Capcasa, Matteo", "count": 1}, {"author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1495, "printer": "Bevilacqua, Simone", "count": 1}, {"author": "PHALARIS", "title": "Epistolae", "year": 1498, "printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "count": 1}, {"author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1488, "printer": "Paltašić, Andrija", "count": 2}, {"author": "PUCIÆ, KARLO", "title": "Elegiarum libellus De laudibus Gnesae puellae", "year": 1495, "printer": "Damianus de Gorgonzola", "count": 2}, {"author": "TERENTIUS AFER, PUBLIUS", "title": "Comoediae", "year": 1487, "printer": "Paltašić, Andrija", "count": 1}, {"author": "TIBULLUS, ALBIUS", "title": "Elegiae", "year": 1487, "printer": "Paltašić, Andrija", "count": 1}, {"author": "TORTELLIUS, JOHANNES", "title": "De orthographia dictionum e Graecis tractarum.", "year": 1488, "printer": "Paltašić, Andrija", "count": 1}, {"author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1497, "printer": "Tacuinus, Giovanni", "count": 1}, {"author": "VERGILIUS MARO, PUBLIUS", "title": "Opera", "year": 1488, "printer": "Paltašić, Andrija", "count": 1}, {"author": "ŠIMUN HVARANIN", "title": "De baptismo Sancti Spiritus et eius virtute", "year": 1477, "printer": "Gallo, Guglielmo", "count": 2}, {"author": "ŠIŽGORIÆ, JURAJ", "title": "Elegiarum et carminum libri tres.", "year": 1477, "printer": "Adamus, Rotwilensis", "count": 1}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 14}, {"place": "Dubrovnik", "institution": "Franjevački samostan Male braće", "count": 5}, {"place": "Dubrovnik", "institution": "Znanstvena knjižnica", "count": 3}, {"place": "Hvar", "institution": "Franjevački samostan Gospe od milosti", "count": 2}, {"place": "Hvar", "institution": "Knjižnica Hvarske biskupije", "count": 2}, {"place": "Kampor", "institution": "Franjevački samostan sv. Bernardina Sijenskog", "count": 2}, {"place": "Koprivnica", "institution": "Franjevački samostan sv. Antuna Padovanskog", "count": 1}, {"place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina", "count": 4}, {"place": "Kraj", "institution": "Franjevački samostan sv. Duje", "count": 1}, {"place": "Našice", "institution": "Franjevački samostan sv. Antuna Padovanskog", "count": 1}, {"place": "Pula", "institution": "Sveučilišna knjižnica u Puli", "count": 1}, {"place": "Rijeka", "institution": "Franjevački samostan Majke Božje Trsatske", "count": 1}, {"place": "Split", "institution": "Bogoslovno sjemenište", "count": 1}, {"place": "Split", "institution": "Dominikanski samostan sv. Katarine", "count": 1}, {"place": "Trogir", "institution": "Muzej grada Trogira", "count": 1}, {"place": "Varaždin", "institution": "Franjevački samostan sv. Ivana Krstitelja", "count": 1}, {"place": "Zadar", "institution": "Državni arhiv u Zadru", "count": 1}, {"place": "Zadar", "institution": "Franjevački samostan sv. Frane", "count": 6}, {"place": "Zadar", "institution": "Nadbiskupski ordinarijat", "count": 1}, {"place": "Zadar", "institution": "Znanstvena knjižnica Sveučilišta u Zadru", "count": 2}, {"place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'", "count": 3}, {"place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti", "count": 2}, {"place": "Zagreb", "institution": "Metropolitanska knjižnica", "count": 6}, {"place": "Zagreb", "institution": "Muzej suvremene umjetnosti", "count": 1}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 28}, {"place": "Šibenik", "institution": "Franjevački samostan sv. Frane", "count": 2}, {"place": "Šibenik", "institution": "Franjevački samostan sv. Lovre", "count": 1}]}, {"place": "Verona", "lat": 45.4424977, "lon": 10.9857377, "total": 7, "printers": [{"name": "Dobrićević, Dobrić", "count": 7}], "years": [{"year": 1481, "count": 5}, {"year": 1483, "count": 2}], "titles": [{"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "count": 5}, {"author": "VALTURIUS, ROBERTUS", "title": "De re militari", "year": 1483, "printer": "Dobrićević, Dobrić", "count": 2}], "storage": [{"place": "Cavtat", "institution": "Zbirka Baltazara Bogišića", "count": 1}, {"place": "Dubrovnik", "institution": "Znanstvena knjižnica", "count": 1}, {"place": "Zadar", "institution": "Znanstvena knjižnica Sveučilišta u Zadru", "count": 1}, {"place": "Zagreb", "institution": "Metropolitanska knjižnica", "count": 1}, {"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 3}]}, {"place": "Vicenza", "lat": 45.6348591, "lon": 11.4063543, "total": 1, "printers": [{"name": "Lichtenstein, Hermann", "count": 1}], "years": [{"year": 1479, "count": 1}], "titles": [{"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "printer": "Lichtenstein, Hermann", "count": 1}], "storage": [{"place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu", "count": 1}]}];
  const ALL_PRINTERS = ["Adamus, Rotwilensis", "Baromić, Blaž", "Bedrièić, Silvestar Turèić, Gašpar Baromić, Blaž", "Benalius, Bernardinus", "Benedictis, Franciscus (Plato) de", "Bevilacqua, Simone", "Bonaccorsi, Francesco", "Braem, Konrad", "Capcasa, Matteo", "Damianus de Gorgonzola", "Darleri, Carlo", "Dobrićević, Dobrić", "Dobrićević, Dobrić Delsera, Miniatus", "Dobrićević, Dobrić Manerva, Bonifacius de", "Gallo, Guglielmo", "Gensberg, Johannes", "Girardengus, Nicolaus, de Novis", "Gregoriis, Johannes de", "Grgur Senjanin Jacobum Britannicum", "Guldinbeck, Bartholomaeus", "Hannibal Foxius", "Kessler, Nicolaus", "Libris, Bartholomeo de", "Lichtenstein, Hermann", "Manzolus, Michael", "Miscomini, Antonio di Bartolommeo", "Nepoznat", "Paganini, Paganino de’, st.", "Paltašić, Andrija", "Paltašić, Andrija Dobrićević, Dobrić", "Paltašić, Andrija Scotus, Octavianus", "Pasqualibus, Peregrinus de Bertochus, Dominicus", "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "Pietro, Gabriele di", "Pincius, Doninus", "Plannck, Stephan", "Ratdolt, Erhard", "Ratdolt, Erhard Löslein, Peter", "Rubeis, Laurentius de, de Valentia", "Scotus, Octavianus", "Silber, Eucharius", "Siliprandi, Domenico", "Sweynheym, Konrad Pannartz, Arnold", "Tacuinus, Giovanni", "Torresanus, Andreas, de Asula Baromić, Blaž", "Typ. Hieronymi", "Vercellensis, Johannes Rubeus", "Wagner, Petrus"];
  const YEAR_MIN = 1470;
  const YEAR_MAX = 1501;

  // UI inicijalizacija
  const sel = document.getElementById('printerSelect');
  ALL_PRINTERS.forEach(p => {
    const o = document.createElement('option'); o.value = p; o.textContent = p; sel.appendChild(o);
  });
  document.getElementById('yearMin').value = YEAR_MIN;
  document.getElementById('yearMax').value = YEAR_MAX;

  // Leaflet karta
  const map = L.map('map').setView([45.1, 15.2], 5);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap'
  }).addTo(map);

  const cluster = L.markerClusterGroup({ disableClusteringAtZoom: 9 });
  map.addLayer(cluster);

  function circleSize(total) {
    return Math.max(6, Math.sqrt(total) * 3);
  }

  function makePopupHTML(item) {
    const uid = Math.abs(hashCode(item.place)) % 1000000000;

    // Tiskari
    const rowsP = item.printers
      .sort((a,b)=>b.count-a.count)
      .map(r=>`<tr><td>${escapeHtml(r.name)}</td><td class='num'>${r.count}</td></tr>`).join('') || "<tr><td colspan='2'><em>Nema podataka</em></td></tr>";

    // Godine
    const rowsY = item.years
      .sort((a,b)=>a.year-b.year)
      .map(r=>`<tr><td>${r.year}</td><td class='num'>${r.count}</td></tr>`).join('') || "<tr><td colspan='2'><em>Nema podataka</em></td></tr>";

    // Naslovi
    const rowsT = item.titles
      .sort((a,b)=> (a.year??0)-(b.year??0) || a.author.localeCompare(b.author) || a.title.localeCompare(b.title))
      .map(r=>`<tr><td>${escapeHtml(r.author)}</td><td>${escapeHtml(r.title)}</td><td class='num'>${r.year??''}</td><td>${escapeHtml(r.printer)}</td></tr>`).join('')
      || "<tr><td colspan='4'><em>Nema podataka</em></td></tr>";

    // Ustanove i mjesta čuvanja
    const rowsS = item.storage
      .sort((a,b)=> a.place.localeCompare(b.place) || a.institution.localeCompare(b.institution))
      .map(r=>`<tr><td>${escapeHtml(r.place)}</td><td>${escapeHtml(r.institution)}</td><td class='num'>${r.count}</td></tr>`).join('')
      || "<tr><td colspan='3'><em>Nema zapisa</em></td></tr>";

    return `
      <style>
        .tab-wrap { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
        .tab-input { position:absolute; opacity:0; }
        .tab-label {
          display:inline-block; padding:6px 10px; margin-right:6px;
          border:1px solid #888; border-bottom:none; border-radius:6px 6px 0 0;
          background:#f0f0f0; cursor:pointer; font-size:13px;
        }
        .tab-panel {
          border:1px solid #888; padding:6px; max-height:240px; overflow:auto;
          background:#fff; border-radius:0 6px 6px 6px;
        }
        .tab-input:checked + .tab-label { background:#fff; font-weight:bold; }
        .tab-input:checked + .tab-label + .tab-panel { display:block; }
        .tab-panel { display:none; }
        .table-mini { width:100%; border-collapse:collapse; font-size:13px; }
        .table-mini th, .table-mini td { padding:4px; border-bottom:1px solid #eee; }
        .table-mini th { text-align:left; }
        .table-mini td.num { text-align:right; }
        .headerline { margin:2px 0 6px 0; font-size:12px; color:#444; }
      </style>
      <div class="tab-wrap">
        <div><b>${escapeHtml(item.place)}</b></div>
        <div class="headerline">Ukupno primjeraka vezanih uz ovo mjesto tiskanja: <b>${item.total}</b></div>

        <input class="tab-input" type="radio" id="tabP-${uid}" name="tabs-${uid}" checked>
        <label class="tab-label" for="tabP-${uid}">Tiskari</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Tiskar</th><th class='num'>Broj</th></tr></thead><tbody>${rowsP}</tbody></table>
        </div>

        <input class="tab-input" type="radio" id="tabY-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabY-${uid}">Godine</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Godina</th><th class='num'>Broj</th></tr></thead><tbody>${rowsY}</tbody></table>
        </div>

        <input class="tab-input" type="radio" id="tabT-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabT-${uid}">Naslovi</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Autor</th><th>Naslov</th><th class='num'>God.</th><th>Tiskar</th></tr></thead><tbody>${rowsT}</tbody></table>
        </div>

        <input class="tab-input" type="radio" id="tabS-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabS-${uid}">Ustanove & mjesta čuvanja</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Mjesto čuvanja</th><th>Ustanova</th><th class='num'>Primjeraka</th></tr></thead><tbody>${rowsS}</tbody></table>
        </div>
      </div>
    `;
  }

  function hashCode(s) {
    let h = 0; for (let i=0;i<s.length;i++) { h = Math.imul(31,h) + s.charCodeAt(i) | 0; } return h;
  }
  function escapeHtml(s) {
    return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#039;');
  }

  let markers = [];
  function buildMarkers(data) {
    cluster.clearLayers();
    markers = [];
    data.forEach(item => {
      const m = L.circleMarker([item.lat, item.lon], {
        radius: Math.max(6, Math.sqrt(item.total)*3),
        color: 'darkblue', weight: 1, fillColor: '#1e3a8a', fillOpacity: 0.65
      }).bindTooltip(`${item.place} — ukupno ${item.total}`, {sticky:true})
        .bindPopup(makePopupHTML(item));
      markers.push({marker: m, props: item});
      cluster.addLayer(m);
    });
  }

  // inicijalno
  buildMarkers(PLACES);

  // FILTERI
  function applyFilters() {
    const q = document.getElementById('placeSearch').value.trim().toLowerCase();
    const printer = document.getElementById('printerSelect').value;
    const yMin = parseInt(document.getElementById('yearMin').value) || YEAR_MIN;
    const yMax = parseInt(document.getElementById('yearMax').value) || YEAR_MAX;

    const subset = PLACES.filter(item => {
      // mjesto tiskanja (substring)
      if (q && !item.place.toLowerCase().includes(q)) return false;

      // tiskar: barem jedan printer na tom mjestu mora odgovarati
      if (printer) {
        const has = item.printers.some(p => p.name === printer);
        if (!has) return false;
      }

      // godine: postoji li barem jedna godina u [yMin, yMax]
      const years = item.years.map(y => y.year).filter(y => y !== null);
      if (years.length) {
        const hasYear = years.some(y => y >= yMin && y <= yMax);
        if (!hasYear) return false;
      }
      return true;
    });

    buildMarkers(subset);
  }

  function resetFilters() {
    document.getElementById('placeSearch').value = '';
    document.getElementById('printerSelect').value = '';
    document.getElementById('yearMin').value = YEAR_MIN;
    document.getElementById('yearMax').value = YEAR_MAX;
    buildMarkers(PLACES);
  }

  document.getElementById('applyBtn').addEventListener('click', applyFilters);
  document.getElementById('resetBtn').addEventListener('click', resetFilters);
  document.getElementById('placeSearch').addEventListener('keyup', (e)=>{ if(e.key==='Enter') applyFilters(); });
</script>
</body>
</html>
